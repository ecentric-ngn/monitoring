<div class="m-5">
    <div class="font-weight-bold h5 mb-4">
        View Registration Compliance Applications
    </div>

    <div class="dropdown">
        <select class="form-select" (change)="onChangeFirmType($event.target.value)">
            <option value="" selected disabled>Firm type</option>
            <option value="contractorFirm">Construction firm</option>
            <option value="consultancyFirm">Consultancy firm</option>
            <option value="specializedFirm">Specialized firm</option>
            <option value="certifiedBuilders">Certified firm</option>
        </select>
    </div>

    <div class="row">
        <div class="col d-flex pl-4">
            <p class="mr-1 p-1 text-gray-600">Items Per Page</p>
            <select class="form-control-sm itemPerPage ml-2" (change)="setLimitValue($event.target.value)"
                style="border-color: #ced4da;">
                <option class="page-item" *ngFor="let limit of set_limit">{{ limit }}</option>
            </select>
        </div>
        <div class="col d-flex justify-content-end">
            <p class="mr-1 p-1 text-gray-600">Search By : </p>
            <input type="text" placeholder="BCTA No or Firm Name" class="form-control form-control-sm col-md-4"
                id="search" [(ngModel)]="searchQuery" (input)="Searchfilter()" />
        </div>
    </div>

    <div class="table-responsive m-3">
        <table class="table table-bordered table-sm">
            <thead class="thead-dark">
                <tr>
                    <th>BCTA No.</th>
                    <th>Firm Name</th>
                    <th>Submitted On</th>
                    <th>Status</th>
                    <th>License Status</th>
                    <th>Verified By</th>
                    <th>Select</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let app of tableData">
                    <td class="text-primary pointer" (click)="navigate(app.bcta_no)">
                        <a routerLink="/monitoring/monitoring/ViewRegDetails">{{ app.bcta_no }}</a>
                    </td>
                    <td>{{ app.firm_name }}</td>
                    <td>{{ app.submitted_on ? (app.submitted_on | date: 'mediumDate') : '-' }}</td>
                    <td>
                        <span [ngClass]="getStatusClass(app.status)">
                            {{ app.status }}
                        </span>
                    </td>
                    <td>
                        <span [ngClass]="getLicenseStatusClass(app.license_status)">
                            {{ app.license_status }}
                        </span>
                    </td>
                    <td>{{ app.verified_by || '-' }}</td>
                    <td class="text-center">
                        <input type="checkbox" [disabled]="app.status === 'Verified'" [(ngModel)]="app.selected"
                            (change)="onCheckboxChange(app)" />
                    </td>
                </tr>
                <tr *ngIf="tableData.length === 0 && !isLoading">
                    <td colspan="7" class="text-center text-muted">No applications found</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="text-center py-3">
        <i class="fa fa-spinner fa-spin"></i> Loading...
    </div>

    <!-- Remarks Section -->
    <div class="m-3">
        <div class="col-md-12 mb-3">
            <label class="form-label me-2 font-size-12">Remarks:</label>
            <input type="text" class="form-control h-10rem" placeholder="Remarks" name="remarks"
                [(ngModel)]="formData.remarks">
        </div>
    </div>
    
    <div class="d-flex justify-content-end m-3">
        <button type="button" 
                class="btn btn-success"
                (click)="SaveAndForward()"
                [disabled]="selectedApplicationNo.length === 0">
            Save & Forward
        </button>
    </div>
</div>